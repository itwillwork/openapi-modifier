# Правило patch-component-schema

## Описание
Правило позволяет модифицировать схему компонента в OpenAPI спецификации. Оно может изменять существующие компоненты, добавляя, изменяя или удаляя их свойства. Поддерживает как полную замену схемы компонента, так и точечные изменения отдельных свойств.

## Конфигурация
Правило принимает объект конфигурации со следующей структурой:

```json
{
  "descriptor": {
    "componentName": "User",
    "correction": "properties.address"
  },
  "patchMethod": "merge",
  "schemaDiff": {
    "type": "object",
    "properties": {
      "zipCode": {
        "type": "string",
        "pattern": "^[0-9]{6}$"
      }
    }
  }
}
```

где:
- `descriptor` - объект, описывающий компонент для модификации:
  - `componentName` - имя компонента в спецификации
  - `correction` (опционально) - путь к свойству внутри компонента, которое нужно изменить
- `patchMethod` - метод применения изменений ('merge' или 'replace')
- `schemaDiff` - схема изменений, которые нужно применить к компоненту

## Мотивация создания правила
Правило было создано для случаев, когда необходимо:
1. Добавить новые свойства в существующие компоненты
2. Изменить типы или ограничения существующих свойств
3. Обновить схемы компонентов без изменения исходной спецификации
4. Применить точечные изменения к вложенным свойствам компонентов

## Случаи использования в других проектах
Правило может быть полезно в следующих сценариях:

1. Расширение существующих моделей данных новыми полями
2. Добавление валидации к существующим полям
3. Рефакторинг структуры данных компонентов
4. Обновление документации при изменении требований к данным

## Примеры использования

### Пример 1: Добавление нового поля
```json
{
  "descriptor": {
    "componentName": "User"
  },
  "patchMethod": "merge",
  "schemaDiff": {
    "properties": {
      "phoneNumber": {
        "type": "string",
        "pattern": "^\\+[0-9]{11}$"
      }
    }
  }
}
```

### Пример 2: Изменение вложенного свойства
```json
{
  "descriptor": {
    "componentName": "Order",
    "correction": "properties.items.items"
  },
  "patchMethod": "merge",
  "schemaDiff": {
    "required": ["quantity", "price"],
    "properties": {
      "quantity": {
        "type": "integer",
        "minimum": 1
      }
    }
  }
}
```

### Пример 3: Полная замена схемы
```json
{
  "descriptor": {
    "componentName": "SimpleUser"
  },
  "patchMethod": "replace",
  "schemaDiff": {
    "type": "object",
    "required": ["id", "name"],
    "properties": {
      "id": {
        "type": "string",
        "format": "uuid"
      },
      "name": {
        "type": "string"
      }
    }
  }
}
```

### Важные замечания
1. Если компонент не найден, правило выводит предупреждение и оставляет спецификацию без изменений
2. При использовании метода `merge`:
   - Существующие свойства сохраняются
   - Новые свойства добавляются
   - Конфликтующие свойства перезаписываются новыми значениями
3. При использовании метода `replace` вся схема компонента заменяется на новую
4. Параметр `correction` позволяет точечно изменять вложенные свойства без затрагивания остальной структуры компонента
5. Правило проверяет корректность конфигурации перед применением изменений 